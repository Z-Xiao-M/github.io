<?xml version='1.0' encoding='UTF-8'?>
<rss xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/" version="2.0"><channel><title>åŒ…é‡Œè£…ç€ä¸ªå¡æ¯”å…½</title><link>https://Z-Xiao-M.github.io/github.io</link><description>å¾…ä¼šå»ç å¤´æ•´ç‚¹è–¯æ¡ğŸŸ</description><copyright>åŒ…é‡Œè£…ç€ä¸ªå¡æ¯”å…½</copyright><docs>http://www.rssboard.org/rss-specification</docs><generator>python-feedgen</generator><image><url>https://z-xiao-m.github.io/github.io/avatar.svg</url><title>avatar</title><link>https://Z-Xiao-M.github.io/github.io</link></image><lastBuildDate>Fri, 05 Sep 2025 16:15:46 +0000</lastBuildDate><managingEditor>åŒ…é‡Œè£…ç€ä¸ªå¡æ¯”å…½</managingEditor><ttl>60</ttl><webMaster>åŒ…é‡Œè£…ç€ä¸ªå¡æ¯”å…½</webMaster><item><title>pg_uprobeâ€”â€”ä¸éœ€è¦ä¿®æ”¹ä»»ä½•ä»£ç ï¼Œå°±å¯ä»¥è§‚æµ‹å†…æ ¸Cå‡½æ•°æ‰§è¡Œæ—¶é—´</title><link>https://Z-Xiao-M.github.io/github.io/post/pg_uprobe%E2%80%94%E2%80%94%E4%B8%8D%E9%9C%80%E8%A6%81%E4%BF%AE%E6%94%B9%E4%BB%BB%E4%BD%95%E4%BB%A3%E7%A0%81%EF%BC%8C%E5%B0%B1%E5%8F%AF%E4%BB%A5%E8%A7%82%E6%B5%8B%E5%86%85%E6%A0%B8C%E5%87%BD%E6%95%B0%E6%89%A7%E8%A1%8C%E6%97%B6%E9%97%B4.html</link><description># å‰è¨€
ä¹‹å‰åœ¨çœ‹ebpfçš„æ—¶å€™ï¼Œäº†è§£åˆ°äº†kprobe ï¼ˆå†…æ ¸æ€æ¢é’ˆï¼‰å’Œ uprobe ï¼ˆç”¨æˆ·æ€æ¢é’ˆï¼‰ã€‚</description><guid isPermaLink="true">https://Z-Xiao-M.github.io/github.io/post/pg_uprobe%E2%80%94%E2%80%94%E4%B8%8D%E9%9C%80%E8%A6%81%E4%BF%AE%E6%94%B9%E4%BB%BB%E4%BD%95%E4%BB%A3%E7%A0%81%EF%BC%8C%E5%B0%B1%E5%8F%AF%E4%BB%A5%E8%A7%82%E6%B5%8B%E5%86%85%E6%A0%B8C%E5%87%BD%E6%95%B0%E6%89%A7%E8%A1%8C%E6%97%B6%E9%97%B4.html</guid><pubDate>Thu, 04 Sep 2025 10:25:58 +0000</pubDate></item><item><title>plpgsqlä¸­çš„éšå¼å­äº‹åŠ¡</title><link>https://Z-Xiao-M.github.io/github.io/post/plpgsql%E4%B8%AD%E7%9A%84%E9%9A%90%E5%BC%8F%E5%AD%90%E4%BA%8B%E5%8A%A1.html</link><description>åœ¨äº‹åŠ¡å—ä¸­è°ƒç”¨å­˜åœ¨å¼‚å¸¸çš„å‡½æ•°

```sql
CREATE TABLE tmp(id int);

CREATE OR REPLACE FUNCTION demo_plpgsql_subxact()
RETURNS void AS $$
BEGIN                        
    INSERT INTO tmp VALUES (-2);
    INSERT INTO tmp VALUES (1/0);  -- error
EXCEPTION
    WHEN division_by_zero THEN
        RAISE INFO '%', SQLERRM;
        INSERT INTO tmp VALUES (-3);            
END;
$$ LANGUAGE plpgsql;

BEGIN; -- å¼€å¯äº‹åŠ¡
INSERT INTO tmp VALUES (-1);
ELECT demo_plpgsql_subxact(); -- è°ƒç”¨å‡½æ•°
select * from tmp;
COMMIT;

truncate tmp;

-- ç­‰ä»·äº
BEGIN; -- å¼€å¯äº‹åŠ¡
INSERT INTO tmp VALUES (-1);
SAVEPOINT exception;  -- ä¿å­˜ç‚¹
INSERT INTO tmp VALUES (-2);
INSERT INTO tmp VALUES (1/0);  -- error
ROLLBACK TO SAVEPOINT exception; -- å¼‚å¸¸å›æ»šåˆ°ä¿å­˜ç‚¹
INSERT INTO tmp VALUES (-3); 
SELECT * FROM tmp;
COMMIT;
```

è¿è¡Œç»“æœ

```sql
postgres@zxm-VMware-Virtual-Platform:~$ psql
psql (16.10)
Type 'help' for help.

postgres=# CREATE TABLE tmp(id int);
CREATE TABLE
postgres=# CREATE OR REPLACE FUNCTION demo_plpgsql_subxact()
postgres-# RETURNS void AS $$
postgres$# BEGIN  
postgres$#     INSERT INTO tmp VALUES (-2);
postgres$#     INSERT INTO tmp VALUES (1/0);  -- error
postgres$# EXCEPTION
postgres$#     WHEN division_by_zero THEN
postgres$#                 RAISE INFO '%', SQLERRM;
postgres$#         INSERT INTO tmp VALUES (-3); 
postgres$# END;
postgres$# $$ LANGUAGE plpgsql;
CREATE FUNCTION
postgres=# BEGIN;
BEGIN
postgres=*# INSERT INTO tmp VALUES (-1);
INSERT 0 1
postgres=*# SELECT demo_plpgsql_subxact(); -- è°ƒç”¨å‡½æ•°
INFO:  division by zero
 demo_plpgsql_subxact 
----------------------
 
(1 row)

postgres=*# select * from tmp;
 id 
----
 -1
 -3
(2 rows)

postgres=*# COMMIT;
COMMIT
postgres=# truncate tmp;
TRUNCATE TABLE
postgres=# BEGIN;
BEGIN
postgres=*# INSERT INTO tmp VALUES (-1);
INSERT 0 1
postgres=*# SAVEPOINT exception;
SAVEPOINT
postgres=*# INSERT INTO tmp VALUES (-2);
INSERT 0 1
postgres=*# INSERT INTO tmp VALUES (1/0);  -- error
ERROR:  division by zero
postgres=!# ROLLBACK TO SAVEPOINT exception;
ROLLBACK
postgres=*# INSERT INTO tmp VALUES (-3); 
INSERT 0 1
postgres=*# COMMIT;
COMMIT
postgres=# SELECT * FROM tmp;
 id 
----
 -1
 -3
(2 rows)

postgres=# 
```

åœ¨äº‹åŠ¡å—ä¸­ï¼Œè°ƒç”¨ä¸å­˜åœ¨å¼‚å¸¸çš„å‡½æ•°

```sql
TRUNCATE tmp;

CREATE OR REPLACE FUNCTION demo_plpgsql_subxact()
RETURNS void AS $$
BEGIN                        
    INSERT INTO tmp VALUES (-2);
    INSERT INTO tmp VALUES (-3);
EXCEPTION
    WHEN division_by_zero THEN
        RAISE INFO '%', SQLERRM;        
END;
$$ LANGUAGE plpgsql;

BEGIN; -- å¼€å¯äº‹åŠ¡å—
INSERT INTO tmp VALUES (-1);
select demo_plpgsql_subxact();
INSERT INTO tmp VALUES (-4);
SELECT * FROM tmp;
COMMIT;


TRUNCATE tmp;
-- ç­‰ä»·äº
BEGIN; -- å¼€å¯äº‹åŠ¡å—
INSERT INTO tmp VALUES (-1);
SAVEPOINT exception;
INSERT INTO tmp VALUES (-2);
INSERT INTO tmp VALUES (-3);
RELEASE SAVEPOINT exception;
INSERT INTO tmp VALUES (-4);
SELECT * FROM tmp;
COMMIT;
```

è¿è¡Œç»“æœ

```sql
postgres@zxm-VMware-Virtual-Platform:~$ psql
psql (16.10)
Type 'help' for help.

postgres=# TRUNCATE tmp;
TRUNCATE TABLE
postgres=# CREATE OR REPLACE FUNCTION demo_plpgsql_subxact()
RETURNS void AS $$
BEGIN                        
    INSERT INTO tmp VALUES (-2);
    INSERT INTO tmp VALUES (-3);
EXCEPTION
    WHEN division_by_zero THEN
        RAISE INFO '%', SQLERRM;        
END;
$$ LANGUAGE plpgsql;
CREATE FUNCTION
postgres=# BEGIN; -- å¼€å¯äº‹åŠ¡å—
BEGIN
postgres=*# INSERT INTO tmp VALUES (-1);
INSERT 0 1
postgres=*# select demo_plpgsql_subxact();
 demo_plpgsql_subxact 
----------------------
 
(1 row)

postgres=*# INSERT INTO tmp VALUES (-4);
INSERT 0 1
postgres=*# SELECT * FROM tmp;
 id 
----
 -1
 -2
 -3
 -4
(4 rows)

postgres=*# COMMIT;
COMMIT
postgres=# TRUNCATE tmp;
TRUNCATE TABLE
postgres=# -- ç­‰ä»·äº
postgres=# BEGIN; -- å¼€å¯äº‹åŠ¡å—
BEGIN
postgres=*# INSERT INTO tmp VALUES (-1);
INSERT 0 1
postgres=*# SAVEPOINT exception; -- å¼€å¯å­äº‹åŠ¡
SAVEPOINT
postgres=*# INSERT INTO tmp VALUES (-2);
INSERT 0 1
postgres=*# INSERT INTO tmp VALUES (-3);
INSERT 0 1
postgres=*# RELEASE SAVEPOINT exception;
RELEASE
postgres=*# INSERT INTO tmp VALUES (-4);
INSERT 0 1
postgres=*# SELECT * FROM tmp;
 id 
----
 -1
 -2
 -3
 -4
(4 rows)

postgres=*# COMMIT;
COMMIT
postgres=# 
```

æ²¡æœ‰exceptionåˆ™ä¸ä¼šè§¦å‘å­äº‹åŠ¡çš„åŠ¨ä½œï¼Œéƒ¨åˆ†`exec_stmt_block`ä»£ç ç‰‡æ®µå¦‚ä¸‹
```c
static int
exec_stmt_block(PLpgSQL_execstate *estate, PLpgSQL_stmt_block *block)
{
  // initialize 
  if (block-&gt;exceptions)
  {
    BeginInternalSubTransaction(NULL);  // å¼€å¯å­äº‹åŠ¡

    PG_TRY();
    {
      /* Run the block's statements */
      rc = exec_stmts(estate, block-&gt;body); // æ‰§è¡Œç›¸å…³æ“ä½œ

      /* Commit the inner transaction, return to outer xact context */
      ReleaseCurrentSubTransaction(); // é‡Šæ”¾å­äº‹åŠ¡
    }
    PG_CATCH();
    {

      /* Abort the inner transaction */
      RollbackAndReleaseCurrentSubTransaction(); // å‘ç”Ÿäº†å¼‚å¸¸å›æ»šå­äº‹åŠ¡

      // å¼‚å¸¸åŒ¹é…å’Œå¤„ç†
      foreach(e, block-&gt;exceptions-&gt;exc_list)
      {
        PLpgSQL_exception *exception = (PLpgSQL_exception *) lfirst(e);
        if (exception_matches_conditions(edata, exception-&gt;conditions))
        {
          rc = exec_stmts(estate, exception-&gt;action); // exceptionå—ä¸­çš„å…¶ä½™æ“ä½œ
          break;
        }
      }
    }
    PG_END_TRY();
  }
  else
  {
    /*
     * Just execute the statements in the block's body
     */
    estate-&gt;err_text = NULL;
    // æ²¡æœ‰exceptionå— æ‰§è¡Œæ­¤å¤„ ä¸ä¼šå¼€å¯å­äº‹åŠ¡
    rc = exec_stmts(estate, block-&gt;body);
  }
  // ...
}
``` ã€‚</description><guid isPermaLink="true">https://Z-Xiao-M.github.io/github.io/post/plpgsql%E4%B8%AD%E7%9A%84%E9%9A%90%E5%BC%8F%E5%AD%90%E4%BA%8B%E5%8A%A1.html</guid><pubDate>Thu, 04 Sep 2025 07:35:19 +0000</pubDate></item><item><title>æ–‡æ‘˜: å¦‚æœæ²¡æœ‰äººè¯»åšå®¢ï¼Œä¸ºä»€ä¹ˆè¦å†™å‘¢ï¼Ÿ</title><link>https://Z-Xiao-M.github.io/github.io/post/%E6%96%87%E6%91%98--%E5%A6%82%E6%9E%9C%E6%B2%A1%E6%9C%89%E4%BA%BA%E8%AF%BB%E5%8D%9A%E5%AE%A2%EF%BC%8C%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E5%86%99%E5%91%A2%EF%BC%9F.html</link><description>&gt; æˆ‘å¶ç„¶çœ‹åˆ°è¿™ä¹ˆä¸€æ®µè¯ï¼Œæƒ³ç®€å•è®°å½•ä¸€ä¸‹

è®©æˆ‘ä»¬å¦ç‡ä¸€ç‚¹å§ï¼Œä½ å†™äº†ä¸€ç¯‡åšå®¢ï¼Œæ ¹æœ¬å°±æ²¡æœ‰äººè¯»ã€‚</description><guid isPermaLink="true">https://Z-Xiao-M.github.io/github.io/post/%E6%96%87%E6%91%98--%E5%A6%82%E6%9E%9C%E6%B2%A1%E6%9C%89%E4%BA%BA%E8%AF%BB%E5%8D%9A%E5%AE%A2%EF%BC%8C%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E5%86%99%E5%91%A2%EF%BC%9F.html</guid><pubDate>Thu, 04 Sep 2025 05:40:35 +0000</pubDate></item><item><title>æŸ¥è¯¢è€—æ—¶åŒä¸´æ—¶è¡¨çš„æ•°é‡å‘ˆçº¿æ€§å¢é•¿</title><link>https://Z-Xiao-M.github.io/github.io/post/%E6%9F%A5%E8%AF%A2%E8%80%97%E6%97%B6%E5%90%8C%E4%B8%B4%E6%97%B6%E8%A1%A8%E7%9A%84%E6%95%B0%E9%87%8F%E5%91%88%E7%BA%BF%E6%80%A7%E5%A2%9E%E9%95%BF.html</link><description>å†…å®¹æ¼”ç¤ºï¼š
```sql
postgres@zxm-VMware-Virtual-Platform:~/code/16$ psql -o /dev/null
psql (16.10)
Type 'help' for help.

postgres=# \timing
Timing is on.
postgres=# select * from pg_database;
Time: 0.491 ms
postgres=# select * from pg_database;
Time: 0.676 ms
postgres=# select * from pg_database;
Time: 0.573 ms
postgres=# CREATE TEMP TABLE a_gtt (n numeric) ON COMMIT DELETE ROWS;
Time: 5.771 ms
postgres=# select * from a_gtt;
Time: 1.721 ms
postgres=# select * from a_gtt;
Time: 1.383 ms
postgres=# select * from a_gtt;
Time: 1.703 ms
postgres=# DO $$
DECLARE
  v_sql VARCHAR(100);
BEGIN
  FOR i IN 1..3000 LOOP
    v_sql := 'CREATE TEMP TABLE a_gtt'||i||'(n numeric) ON COMMIT DELETE ROWS';
    EXECUTE v_sql;
  END LOOP;
END;
$$ LANGUAGE plpgsql;
Time: 4150.059 ms (00:04.150)
postgres=# select * from a_gtt;
Time: 1250.611 ms (00:01.251)
postgres=# select * from a_gtt;
Time: 1239.305 ms (00:01.239)
postgres=# select * from a_gtt;
Time: 1213.000 ms (00:01.213)
postgres=# select * from pg_database;
Time: 1.975 ms
postgres=# select * from pg_database;
Time: 0.981 ms
postgres=# select * from pg_database;
Time: 0.758 ms
```
ç²—ç•¥çš„åˆ¤æ–­ï¼Œæ²¡æœ‰ä»”ç»†ç ”ç©¶ï¼Œä¼°è®¡åŸå› åœ¨äºéœ€è¦å¤šæ¬¡éå†å¤§çš„listï¼Œä»¥åŠè¿˜éœ€è¦å¯¹ä¸´æ—¶è¡¨åšä¸€äº›é¢å¤–çš„æ¸…ç†å·¥ä½œ
```c
// å’Œon_commits æ¯æ¯ç›¸å…³
static List *on_commits = NIL;
```
åœ¨åˆ›å»ºä¸´æ—¶è¡¨æ—¶ï¼Œå¦‚æœå­˜åœ¨ON COMMITçš„åŠ¨ä½œ å°±ä¼šå°†å…¶åŠ¨ä½œæ³¨å†Œåˆ°è¿™ä¸ªå˜é‡ä¸­
```c
/* What to do at commit time for temporary relations */
typedef enum OnCommitAction
{
	ONCOMMIT_NOOP,				/* No ON COMMIT clause (do nothing) */
	ONCOMMIT_PRESERVE_ROWS,		/* ON COMMIT PRESERVE ROWS (do nothing) */
	ONCOMMIT_DELETE_ROWS,		/* ON COMMIT DELETE ROWS */
	ONCOMMIT_DROP				/* ON COMMIT DROP */
} OnCommitAction;


// heap_create_with_catalog
	 * If there's a special on-commit action, remember it
	 */
	if (oncommit != ONCOMMIT_NOOP)
		register_on_commit_action(relid, oncommit);

/*
 * Register a newly-created relation's ON COMMIT action.
 */
void
register_on_commit_action(Oid relid, OnCommitAction action)
{
	OnCommitItem *oc;
	MemoryContext oldcxt;

	/*
	 * We needn't bother registering the relation unless there is an ON COMMIT
	 * action we need to take.
	 */
	if (action == ONCOMMIT_NOOP || action == ONCOMMIT_PRESERVE_ROWS)
		return;

	oldcxt = MemoryContextSwitchTo(CacheMemoryContext);

	oc = (OnCommitItem *) palloc(sizeof(OnCommitItem));
	oc-&gt;relid = relid;
	oc-&gt;oncommit = action;
	oc-&gt;creating_subid = GetCurrentSubTransactionId();
	oc-&gt;deleting_subid = InvalidSubTransactionId;

	/*
	 * We use lcons() here so that ON COMMIT actions are processed in reverse
	 * order of registration.  That might not be essential but it seems
	 * reasonable.
	 */
	on_commits = lcons(oc, on_commits);

	MemoryContextSwitchTo(oldcxt);
}
```
è€Œåœ¨äº‹åŠ¡å°†è¦å®Œæˆä¹‹å‰ï¼Œéœ€è¦å¤„ç†è¿™ä¸ªlistä¸­çš„ç›¸å…³å†…å®¹
```c
/*
 * Perform ON COMMIT actions.
 *
 * This is invoked just before actually committing, since it's possible
 * to encounter errors.
 */
void
PreCommit_on_commit_actions(void)
{
	ListCell   *l;
	List	   *oids_to_truncate = NIL;
	List	   *oids_to_drop = NIL;

         // éå†
	foreach(l, on_commits)
	{
		OnCommitItem *oc = (OnCommitItem *) lfirst(l);

		/* Ignore entry if already dropped in this xact */
		if (oc-&gt;deleting_subid != InvalidSubTransactionId)
			continue;

		switch (oc-&gt;oncommit)
		{
			case ONCOMMIT_NOOP:
			case ONCOMMIT_PRESERVE_ROWS:
				/* Do nothing (there shouldn't be such entries, actually) */
				break;
			case ONCOMMIT_DELETE_ROWS:

				/*
				 * If this transaction hasn't accessed any temporary
				 * relations, we can skip truncating ON COMMIT DELETE ROWS
				 * tables, as they must still be empty.
				 */
				if ((MyXactFlags &amp; XACT_FLAGS_ACCESSEDTEMPNAMESPACE))
					oids_to_truncate = lappend_oid(oids_to_truncate, oc-&gt;relid); // ç”Ÿæˆæ–°çš„list
				break;
			case ONCOMMIT_DROP:
				oids_to_drop = lappend_oid(oids_to_drop, oc-&gt;relid);
				break;
		}
	}

	/*
	 * Truncate relations before dropping so that all dependencies between
	 * relations are removed after they are worked on.  Doing it like this
	 * might be a waste as it is possible that a relation being truncated will
	 * be dropped anyway due to its parent being dropped, but this makes the
	 * code more robust because of not having to re-check that the relation
	 * exists at truncation time.
	 */
	if (oids_to_truncate != NIL)
		heap_truncate(oids_to_truncate); // æ–°çš„listéœ€è¦å¤„ç†

	if (oids_to_drop != NIL)
	{
		ObjectAddresses *targetObjects = new_object_addresses();

		foreach(l, oids_to_drop)
		{
			ObjectAddress object;

			object.classId = RelationRelationId;
			object.objectId = lfirst_oid(l);
			object.objectSubId = 0;

			Assert(!object_address_present(&amp;object, targetObjects));

			add_exact_object_address(&amp;object, targetObjects);
		}

		/*
		 * Object deletion might involve toast table access (to clean up
		 * toasted catalog entries), so ensure we have a valid snapshot.
		 */
		PushActiveSnapshot(GetTransactionSnapshot());

		/*
		 * Since this is an automatic drop, rather than one directly initiated
		 * by the user, we pass the PERFORM_DELETION_INTERNAL flag.
		 */
		performMultipleDeletions(targetObjects, DROP_CASCADE,
								 PERFORM_DELETION_INTERNAL | PERFORM_DELETION_QUIETLY);

		PopActiveSnapshot();

#ifdef USE_ASSERT_CHECKING

		/*
		 * Note that table deletion will call remove_on_commit_action, so the
		 * entry should get marked as deleted.
		 */
		foreach(l, on_commits)
		{
			OnCommitItem *oc = (OnCommitItem *) lfirst(l);

			if (oc-&gt;oncommit != ONCOMMIT_DROP)
				continue;

			Assert(oc-&gt;deleting_subid != InvalidSubTransactionId);
		}
#endif
	}
}
``` 
è°ƒè¯•å¯ä»¥çœ‹åˆ°ï¼š
&lt;img width='1062' height='1040' alt='Image' src='https://github.com/user-attachments/assets/8e0198e4-ef63-47a3-96f3-7b8399fac7d2' /&gt;

å…¶å®ä¸»è¦è€—æ—¶åº”è¯¥è¿˜æ˜¯`heap_truncate`
```c
void
heap_truncate(List *relids)
{
	List	   *relations = NIL;
	ListCell   *cell;

        // éå†
	/* Open relations for processing, and grab exclusive access on each */
	foreach(cell, relids)
	{
		Oid			rid = lfirst_oid(cell);
		Relation	rel;

		rel = table_open(rid, AccessExclusiveLock);
		relations = lappend(relations, rel);  // ç”Ÿæˆæ–°çš„list
	}

	/* Don't allow truncate on tables that are referenced by foreign keys */
	heap_truncate_check_FKs(relations, true); // å…¶å®è¿™å†…éƒ¨è¿˜æœ‰éå†

        // å†æ¬¡éå†
	/* OK to do it */
	foreach(cell, relations)
	{
		Relation	rel = lfirst(cell);

		/* Truncate the relation */
		heap_truncate_one_rel(rel);  // ä¼°è®¡å¤§éƒ¨åˆ†çš„è€—æ—¶åœ¨æ­¤å¤„

		/* Close the relation, but keep exclusive lock on it until commit */
		table_close(rel, NoLock);
	}
}
```
è°ƒè¯•å¯ä»¥çœ‹åˆ°ï¼š
&lt;img width='1011' height='766' alt='Image' src='https://github.com/user-attachments/assets/8bcde450-2946-43ef-8db6-d67742f15338' /&gt;


heap_truncate_check_FKsä¸­è¿˜å­˜åœ¨éå†ï¼Œè°ƒè¯•å¯ä»¥çœ‹åˆ°ï¼š
&lt;img width='1038' height='478' alt='Image' src='https://github.com/user-attachments/assets/6db8a667-7d7d-4988-8873-48f9657627bb' /&gt;

åŠ äº†äº›æ‰“å°ï¼Œçœ‹çš„æ›´æ¸…æ¥šä¸€äº›

```sql
postgres@zxm-VMware-Virtual-Platform:~/code/16$ psql -o /dev/null
INFO:  PreCommit_on_commit_actions time: 0.000 ms

psql (16.10)
Type 'help' for help.

postgres=# \timing
Timing is on.
postgres=# select * from pg_database;
INFO:  PreCommit_on_commit_actions time: 0.000 ms

Time: 1.724 ms
postgres=# select * from pg_database;
INFO:  PreCommit_on_commit_actions time: 0.000 ms

Time: 0.636 ms
postgres=# select * from pg_database;
INFO:  PreCommit_on_commit_actions time: 0.000 ms

Time: 0.634 ms
postgres=# CREATE TEMP TABLE a_gtt (n numeric) ON COMMIT DELETE ROWS;
INFO:  heap_truncate time: 0.534 ms

INFO:  PreCommit_on_commit_actions time: 0.618 ms

Time: 16.613 ms
postgres=# select * from a_gtt;
INFO:  heap_truncate time: 0.756 ms

INFO:  PreCommit_on_commit_actions time: 0.834 ms

Time: 2.341 ms
postgres=# select * from a_gtt;
INFO:  heap_truncate time: 0.727 ms

INFO:  PreCommit_on_commit_actions time: 0.789 ms

Time: 1.372 ms
postgres=# select * from a_gtt;
INFO:  heap_truncate time: 0.838 ms

INFO:  PreCommit_on_commit_actions time: 0.918 ms

Time: 1.746 ms
postgres=# DO $$
DECLARE
  v_sql VARCHAR(100);
BEGIN
  FOR i IN 1..3000 LOOP
    v_sql := 'CREATE TEMP TABLE a_gtt'||i||'(n numeric) ON COMMIT DELETE ROWS';
    EXECUTE v_sql;
  END LOOP;
END;
$$ LANGUAGE plpgsql;
INFO:  heap_truncate time: 1048.421 ms

INFO:  PreCommit_on_commit_actions time: 1048.570 ms

Time: 3854.843 ms (00:03.855)
postgres=# select * from a_gtt;
INFO:  PreCommit_on_commit_actions time: 0.053 ms

INFO:  heap_truncate time: 1234.707 ms

INFO:  PreCommit_on_commit_actions time: 1234.880 ms

Time: 1242.413 ms (00:01.242)
postgres=# select * from a_gtt;
INFO:  PreCommit_on_commit_actions time: 0.039 ms

INFO:  heap_truncate time: 1199.870 ms

INFO:  PreCommit_on_commit_actions time: 1200.038 ms

Time: 1207.323 ms (00:01.207)
postgres=# select * from a_gtt;
INFO:  PreCommit_on_commit_actions time: 0.038 ms

INFO:  heap_truncate time: 1384.979 ms

INFO:  PreCommit_on_commit_actions time: 1385.284 ms

Time: 1393.626 ms (00:01.394)
postgres=# select * from pg_database;
INFO:  PreCommit_on_commit_actions time: 0.063 ms

INFO:  PreCommit_on_commit_actions time: 0.092 ms

Time: 2.293 ms
postgres=# select * from pg_database;
INFO:  PreCommit_on_commit_actions time: 0.111 ms

Time: 0.963 ms
postgres=# select * from pg_database;
INFO:  PreCommit_on_commit_actions time: 0.103 ms

Time: 0.933 ms
postgres=# 
```
æ²¡ä¿®æ”¹ä»€ä¹ˆä»£ç 
```c
diff --git a/src/backend/catalog/heap.c b/src/backend/catalog/heap.c
index e67ffc37b7d..d3d85cb1264 100644
--- a/src/backend/catalog/heap.c
+++ b/src/backend/catalog/heap.c
@@ -75,6 +75,7 @@
 #include 'utils/lsyscache.h'
 #include 'utils/syscache.h'
 
+#include 'portability/instr_time.h'
 
 /* Potentially set by pg_upgrade_support functions */
 Oid                    binary_upgrade_next_heap_pg_class_oid = InvalidOid;
@@ -3070,6 +3071,9 @@ heap_truncate(List *relids)
 {
        List       *relations = NIL;
        ListCell   *cell;
+       instr_time  start;
+       instr_time  duration;
+       INSTR_TIME_SET_CURRENT(start);
 
        /* Open relations for processing, and grab exclusive access on each */
        foreach(cell, relids)
@@ -3095,6 +3099,10 @@ heap_truncate(List *relids)
                /* Close the relation, but keep exclusive lock on it until commit */
                table_close(rel, NoLock);
        }
+
+       INSTR_TIME_SET_CURRENT(duration);
+       INSTR_TIME_SUBTRACT(duration, start);
+       elog(INFO, 'heap_truncate time: %.3f ms\n', INSTR_TIME_GET_MILLISEC(duration));
 }
 
 /*
diff --git a/src/backend/commands/tablecmds.c b/src/backend/commands/tablecmds.c
index 016ae0a65f9..0172ec8bc5e 100644
--- a/src/backend/commands/tablecmds.c
+++ b/src/backend/commands/tablecmds.c
@@ -105,6 +105,8 @@
 #include 'utils/typcache.h'
 #include 'utils/usercontext.h'
 
+#include 'portability/instr_time.h'
+
 /*
  * ON COMMIT action list
  */
@@ -17120,6 +17122,9 @@ PreCommit_on_commit_actions(void)
        ListCell   *l;
        List       *oids_to_truncate = NIL;
        List       *oids_to_drop = NIL;
+       instr_time  start;
+       instr_time  duration;
+       INSTR_TIME_SET_CURRENT(start);
 
        foreach(l, on_commits)
        {
@@ -17211,6 +17216,10 @@ PreCommit_on_commit_actions(void)
                }
 #endif
        }
+
+       INSTR_TIME_SET_CURRENT(duration);
+       INSTR_TIME_SUBTRACT(duration, start);
+       elog(INFO, 'PreCommit_on_commit_actions time: %.3f ms\n', INSTR_TIME_GET_MILLISEC(duration));
 }
 
 /*
```
æ¥è‡ªtom laneçš„è¯„ä»·ï¼Œå› ä¸ºåœºæ™¯æ¯”è¾ƒå•ä¸€ï¼Œå¯¹äºä¼˜åŒ–æ­¤å¤„è¦å¢åŠ ä»£ç å¤æ‚åº¦ï¼Œè®©ä»–å¹¶ä¸æ„Ÿå…´è¶£

&lt;img width='664' height='517' alt='Image' src='https://github.com/user-attachments/assets/e05f943c-057d-4d46-882e-2b0fdd31ac72' /&gt;ã€‚</description><guid isPermaLink="true">https://Z-Xiao-M.github.io/github.io/post/%E6%9F%A5%E8%AF%A2%E8%80%97%E6%97%B6%E5%90%8C%E4%B8%B4%E6%97%B6%E8%A1%A8%E7%9A%84%E6%95%B0%E9%87%8F%E5%91%88%E7%BA%BF%E6%80%A7%E5%A2%9E%E9%95%BF.html</guid><pubDate>Wed, 03 Sep 2025 09:19:04 +0000</pubDate></item><item><title>ç®€å•è§£æä¸‹Toast</title><link>https://Z-Xiao-M.github.io/github.io/post/%E7%AE%80%E5%8D%95%E8%A7%A3%E6%9E%90%E4%B8%8BToast.html</link><description># ä»€ä¹ˆæ˜¯TOAST

PostgreSQL çš„ TOASTï¼ˆThe Oversized-Attribute Storage Techniqueï¼Œè¶…å¤§å±æ€§å­˜å‚¨æŠ€æœ¯ï¼‰æ˜¯é’ˆå¯¹å¤§å°ºå¯¸æ•°æ®ï¼ˆå¦‚é•¿æ–‡æœ¬ã€äºŒè¿›åˆ¶æ•°æ®ç­‰ï¼‰çš„å­˜å‚¨ä¼˜åŒ–æœºåˆ¶ï¼Œå½“å­—æ®µæ•°æ®è¶…è¿‡é˜ˆå€¼æ—¶ï¼Œä¼šè‡ªåŠ¨å°†å…¶å‹ç¼©æˆ–æ‹†åˆ†åå­˜å‚¨åˆ°ç‹¬ç«‹çš„ TOAST è¡¨ä¸­ï¼Œä¸»è¡¨ä»…ä¿ç•™å¼•ç”¨æŒ‡é’ˆï¼Œæ—¢è§£å†³äº†å•æ¡è®°å½•å­˜å‚¨å®¹é‡å—é™é—®é¢˜ï¼Œåˆé€šè¿‡é€æ˜æ“ä½œã€å¤šç§å­˜å‚¨ç­–ç•¥å’Œç‹¬ç«‹è¡¨è®¾è®¡ï¼Œå¹³è¡¡äº†å­˜å‚¨æ•ˆç‡ä¸è®¿é—®æ€§èƒ½ï¼Œå¯¹ TEXTã€BYTEAã€JSONB ç­‰å¯èƒ½å­˜å‚¨å¤§æ•°æ®çš„ç±»å‹å°¤ä¸ºæœ‰æ•ˆã€‚</description><guid isPermaLink="true">https://Z-Xiao-M.github.io/github.io/post/%E7%AE%80%E5%8D%95%E8%A7%A3%E6%9E%90%E4%B8%8BToast.html</guid><pubDate>Wed, 03 Sep 2025 05:42:58 +0000</pubDate></item><item><title>CREATE TABLEå’Œæ–‡ä»¶åˆ†æ”¯</title><link>https://Z-Xiao-M.github.io/github.io/post/CREATE-TABLE%E5%92%8C%E6%96%87%E4%BB%B6%E5%88%86%E6%94%AF.html</link><description># æ–‡ä»¶åˆ†æ”¯

åœ¨ PostgreSQL ä¸­ï¼Œä¸€ä¸ªè¡¨çš„æ‰€æœ‰ä¿¡æ¯åˆ†åˆ«å­˜å‚¨åœ¨å‡ ä¸ªä¸åŒçš„åˆ†æ”¯ä¸­ï¼Œæ¯ä¸ªåˆ†æ”¯åŒ…å«ç‰¹å®šç±»å‹çš„æ•°æ®ï¼Œåˆ†æ”¯æ–‡ä»¶çš„å­˜æ”¾è·¯å¾„é€šå¸¸ä¸º\$PGDATA/base/\[æ•°æ®åº“OID]/xxxï¼Œå½“å…¶å¤§å°è¾¾åˆ° 1GB ï¼ˆé»˜è®¤å€¼ï¼Œå¯ä»¥ç¼–è¯‘æ—¶ä¿®æ”¹ï¼‰æ—¶ï¼Œå°±ä¼šåˆ›å»ºè¯¥åˆ†æ”¯çš„å¦ä¸€ä¸ªæ–‡ä»¶ (è¿™äº›æ–‡ä»¶æœ‰æ—¶è¢«ç§°ä¸ºæ®µ)ã€‚</description><guid isPermaLink="true">https://Z-Xiao-M.github.io/github.io/post/CREATE-TABLE%E5%92%8C%E6%96%87%E4%BB%B6%E5%88%86%E6%94%AF.html</guid><pubDate>Tue, 02 Sep 2025 10:13:12 +0000</pubDate></item><item><title>ä¸¤è¡¨åˆ«åä¸€è‡´èƒ½åšå…³è”æŸ¥è¯¢å—ï¼Ÿ</title><link>https://Z-Xiao-M.github.io/github.io/post/%E4%B8%A4%E8%A1%A8%E5%88%AB%E5%90%8D%E4%B8%80%E8%87%B4%E8%83%BD%E5%81%9A%E5%85%B3%E8%81%94%E6%9F%A5%E8%AF%A2%E5%90%97%EF%BC%9F.html</link><description>### ä¸¤è¡¨åˆ«åä¸€è‡´èƒ½åšå…³è”æŸ¥è¯¢å—
æŒ‰ç…§æ­£å¸¸çš„ç†è§£ï¼Œä¸€èˆ¬æ˜¯ä¸èƒ½çš„ï¼Œå°±åƒPostgreSQL
```sql
postgres=# create table t10(id1 int, name1 varchar(32));
CREATE TABLE
postgres=# create table t11(id2 int, name2 varchar(32));
CREATE TABLE
postgres=# insert into t10 values(1,'test1');
INSERT 0 1
postgres=# insert into t10 values(2,'test2');
INSERT 0 1
postgres=# insert into t11 values(1,'test3');
INSERT 0 1
postgres=# select bc.name2 from t10 bc left join t11 bc on bc.id1 = bc.id2;
ERROR:  table name 'bc' specified more than once
postgres=# 
```
ä½†æ˜¯Oracleä¸ä¸€æ ·ï¼Œå®ƒè¿˜çœŸèƒ½æ‰§è¡Œï¼Œæ‰§è¡Œç»“æœå¦‚ä¸‹

```sql
SQL&gt; create table t10(id1 int, name1 varchar2(32));

Table created.

SQL&gt; create table t11(id2 int, name2 varchar2(32));

Table created.

SQL&gt; insert into t10 values(1,'test1');

1 row created.

SQL&gt; insert into t10 values(2,'test2');

1 row created.

SQL&gt; insert into t11 values(1,'test3');

1 row created.

SQL&gt; EXPLAIN PLAN FOR select bc.name2 from t10 bc left join t11 bc on bc.id1 = bc.id2;

Explained.

SQL&gt; SELECT * FROM TABLE(DBMS_XPLAN.DISPLAY);

PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------
Plan hash value: 1151093956

---------------------------------------------------------------------------
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |
---------------------------------------------------------------------------
|   0 | SELECT STATEMENT   |      |     2 |    88 |     6   (0)| 00:00:01 |
|*  1 |  HASH JOIN OUTER   |      |     2 |    88 |     6   (0)| 00:00:01 |
|   2 |   TABLE ACCESS FULL| T10  |     2 |    26 |     3   (0)| 00:00:01 |
|   3 |   TABLE ACCESS FULL| T11  |     1 |    31 |     3   (0)| 00:00:01 |
---------------------------------------------------------------------------


PLAN_TABLE_OUTPUT
--------------------------------------------------------------------------------
Predicate Information (identified by operation id):
---------------------------------------------------

   1 - access('BC'.'ID1'='BC'.'ID2'(+))

Note
-----
   - dynamic statistics used: dynamic sampling (level=2)

19 rows selected.

SQL&gt; select bc.name2 from t10 bc left join t11 bc on bc.id1 = bc.id2;

NAME2
--------------------------------------------------------------------------------
test3


SQL&gt; 
``` 
æƒ³ä¸é€šoracleä¸ºä»€ä¹ˆè¦æ”¯æŒè¿™ç§å†™æ³•ï¼Œæ­¤å¤„ç”¨ä½œè®°å½•~

ã€‚</description><guid isPermaLink="true">https://Z-Xiao-M.github.io/github.io/post/%E4%B8%A4%E8%A1%A8%E5%88%AB%E5%90%8D%E4%B8%80%E8%87%B4%E8%83%BD%E5%81%9A%E5%85%B3%E8%81%94%E6%9F%A5%E8%AF%A2%E5%90%97%EF%BC%9F.html</guid><pubDate>Mon, 01 Sep 2025 08:11:22 +0000</pubDate></item><item><title>Oracle"ç‰¹è‰²"â€”â€”å¸¸é‡/å˜é‡å……å½“å‡½æ•°å…¥å‚é»˜è®¤å€¼</title><link>https://Z-Xiao-M.github.io/github.io/post/Oracle-%E7%89%B9%E8%89%B2-%E2%80%94%E2%80%94%E5%B8%B8%E9%87%8F-%E5%8F%98%E9%87%8F%E5%85%85%E5%BD%93%E5%87%BD%E6%95%B0%E5%85%A5%E5%8F%82%E9%BB%98%E8%AE%A4%E5%80%BC.html</link><description>è¯šå¦‚ä»Šå¤©çš„ä¸»é¢˜æ‰€è¨€ï¼š'åŒå­¦ï¼Œä½ èƒ½æ¥å—å¸¸é‡/å˜é‡å……å½“å‡½æ•°å…¥å‚é»˜è®¤å€¼å—ï¼Ÿ'

åœ¨PL/SQLä¸­ï¼Œå‡½æ•°å…¥å‚é»˜è®¤å€¼ä¸å°±æ˜¯è¾“å…¥å‚æ•°ç±»å‹åé¢çš„DEFAULTï¼Œå°±å¥½æ¯”ç¤ºä¾‹ä¸­çš„256ï¼Œé€šå¸¸æ¥è¯´éƒ½æ˜¯ä¸€ä¸ªå†™å®šäº†çš„æ•°æ®å€¼ã€‚</description><guid isPermaLink="true">https://Z-Xiao-M.github.io/github.io/post/Oracle-%E7%89%B9%E8%89%B2-%E2%80%94%E2%80%94%E5%B8%B8%E9%87%8F-%E5%8F%98%E9%87%8F%E5%85%85%E5%BD%93%E5%87%BD%E6%95%B0%E5%85%A5%E5%8F%82%E9%BB%98%E8%AE%A4%E5%80%BC.html</guid><pubDate>Mon, 01 Sep 2025 07:15:05 +0000</pubDate></item><item><title>Oracle"ç‰¹è‰²"â€”â€”è‡ªå®šä¹‰å¸¦é»˜è®¤å€¼çš„å¤åˆç±»å‹</title><link>https://Z-Xiao-M.github.io/github.io/post/Oracle-%E7%89%B9%E8%89%B2-%E2%80%94%E2%80%94%E8%87%AA%E5%AE%9A%E4%B9%89%E5%B8%A6%E9%BB%98%E8%AE%A4%E5%80%BC%E7%9A%84%E5%A4%8D%E5%90%88%E7%B1%BB%E5%9E%8B.html</link><description>ä»Šå¤©çš„è¿™ä¸ªä¸»é¢˜å°±å¾ˆæ˜¾è€Œæ˜“è§äº†ï¼Œè¿™ä¸ªæˆ‘è§‰å¾—æ€ªæ€ªçš„æƒ³è¦è¿›è¡Œåˆ†äº«çš„åŸå› æ˜¯ï¼š

**ä½ ç”šè‡³å¯ä»¥åœ¨Oracleæ•°æ®åº“å†…éƒ¨å®šä¹‰å‡ºå¸¦é»˜è®¤å€¼çš„å¤åˆç±»å‹ï¼ï¼ï¼ä¸»è¦å…¶å®ä¹Ÿæ˜¯æˆ‘ç©PGç©å¤šäº†ï¼Œæ²¡ç…è§è¿‡è‡ªå¸¦é»˜è®¤å€¼çš„å¤åˆç±»å‹ã€‚</description><guid isPermaLink="true">https://Z-Xiao-M.github.io/github.io/post/Oracle-%E7%89%B9%E8%89%B2-%E2%80%94%E2%80%94%E8%87%AA%E5%AE%9A%E4%B9%89%E5%B8%A6%E9%BB%98%E8%AE%A4%E5%80%BC%E7%9A%84%E5%A4%8D%E5%90%88%E7%B1%BB%E5%9E%8B.html</guid><pubDate>Mon, 01 Sep 2025 07:14:11 +0000</pubDate></item><item><title>"é¢—ç²’åº¦"æ²¡å¯¹é½â€”â€”è®©äººè´¹è§£çš„CHARï¼ˆ1ï¼‰</title><link>https://Z-Xiao-M.github.io/github.io/post/-%E9%A2%97%E7%B2%92%E5%BA%A6-%E6%B2%A1%E5%AF%B9%E9%BD%90%E2%80%94%E2%80%94%E8%AE%A9%E4%BA%BA%E8%B4%B9%E8%A7%A3%E7%9A%84CHAR%EF%BC%881%EF%BC%89.html</link><description>çœ‹åˆ°ä»Šå¤©çš„ä¸»é¢˜ï¼Œå¯èƒ½æœ‰ä¸å°‘çš„æœ‹å‹ä¼šåæ§½ä¸€ä¸ªOracleçš„CHARï¼ˆ1ï¼‰ç±»å‹æœ‰ä»€ä¹ˆè®©äººè´¹è§£çš„è¿™ä¸æ˜¯ç®€ç®€å•å•å—ï¼Ÿè€Œä¸”CHARï¼ˆ1ï¼‰åœ¨å„ä¸ªæ•°æ®åº“ä¸­ä¹Ÿéƒ½æ”¯æŒçš„å‘€ï¼Ÿæˆ‘æƒ³è¯´çš„æ˜¯å¤§ä¼™ï¼Œåˆ«ç€æ€¥å’±ä»¬æ¥ä¸‹æ¥æ…¢æ…¢çœ‹ã€‚</description><guid isPermaLink="true">https://Z-Xiao-M.github.io/github.io/post/-%E9%A2%97%E7%B2%92%E5%BA%A6-%E6%B2%A1%E5%AF%B9%E9%BD%90%E2%80%94%E2%80%94%E8%AE%A9%E4%BA%BA%E8%B4%B9%E8%A7%A3%E7%9A%84CHAR%EF%BC%881%EF%BC%89.html</guid><pubDate>Mon, 01 Sep 2025 07:12:58 +0000</pubDate></item><item><title>ç¾²å’Œï¼ˆhaloï¼‰æ•°æ®åº“é›†åˆç±»å‹ç³»åˆ—â€”â€”å­¦ä¼šå¯å˜æ•°ç»„(Varray)çš„æ­£ç¡®ä½¿ç”¨</title><link>https://Z-Xiao-M.github.io/github.io/post/%E7%BE%B2%E5%92%8C%EF%BC%88halo%EF%BC%89%E6%95%B0%E6%8D%AE%E5%BA%93%E9%9B%86%E5%90%88%E7%B1%BB%E5%9E%8B%E7%B3%BB%E5%88%97%E2%80%94%E2%80%94%E5%AD%A6%E4%BC%9A%E5%8F%AF%E5%8F%98%E6%95%B0%E7%BB%84%28Varray%29%E7%9A%84%E6%AD%A3%E7%A1%AE%E4%BD%BF%E7%94%A8.html</link><description>ä¸€ã€å‰è¨€  

å‰ä¸ä¹…ï¼Œå’±ä»¬å¸¦æ¥äº†å…³äºç¾²å’Œæ•°æ®åº“é›†åˆç±»å‹ä¸­çš„åµŒå¥—è¡¨ã€å…³è”æ•°ç»„çš„ä½¿ç”¨ï¼Œå› ä¸ºä¸­é€”ä¸´æ—¶æœ‰äº‹æƒ…è¦å¿™ï¼Œæ‰€ä»¥å°å’•äº†ä¸€ä¼šï¼Œç›¸å…³é“¾æ¥å¦‚ä¸‹

[ç¾²å’Œï¼ˆhaloï¼‰æ•°æ®åº“é›†åˆç±»å‹ç³»åˆ—â€”â€”å­¦ä¼šåµŒå¥—è¡¨(Nested Table)çš„æ­£ç¡®ä½¿ç”¨](https://www.modb.pro/db/1844644828275109888)  

[ç¾²å’Œï¼ˆhaloï¼‰æ•°æ®åº“é›†åˆç±»å‹ç³»åˆ—â€”â€”å…³è”æ•°ç»„ï¼ˆAssociative Arrayï¼‰](https://www.modb.pro/db/1845638860305432576)  

ä»Šå¤©è¦ç»™å¤§å®¶å¸¦æ¥çš„æ˜¯**ç¾²å’Œï¼ˆhaloï¼‰æ•°æ®åº“é›†åˆç±»å‹åŸºç¡€ç”¨æ³•æœ€ç»ˆç« â€”â€”****å¯å˜æ•°ç»„(Varray)****ç›¸å…³å†…å®¹ã€‚</description><guid isPermaLink="true">https://Z-Xiao-M.github.io/github.io/post/%E7%BE%B2%E5%92%8C%EF%BC%88halo%EF%BC%89%E6%95%B0%E6%8D%AE%E5%BA%93%E9%9B%86%E5%90%88%E7%B1%BB%E5%9E%8B%E7%B3%BB%E5%88%97%E2%80%94%E2%80%94%E5%AD%A6%E4%BC%9A%E5%8F%AF%E5%8F%98%E6%95%B0%E7%BB%84%28Varray%29%E7%9A%84%E6%AD%A3%E7%A1%AE%E4%BD%BF%E7%94%A8.html</guid><pubDate>Mon, 01 Sep 2025 07:10:44 +0000</pubDate></item><item><title>ç¾²å’Œï¼ˆhaloï¼‰æ•°æ®åº“é›†åˆç±»å‹ç³»åˆ—â€”â€”å…³è”æ•°ç»„ï¼ˆAssociative Arrayï¼‰</title><link>https://Z-Xiao-M.github.io/github.io/post/%E7%BE%B2%E5%92%8C%EF%BC%88halo%EF%BC%89%E6%95%B0%E6%8D%AE%E5%BA%93%E9%9B%86%E5%90%88%E7%B1%BB%E5%9E%8B%E7%B3%BB%E5%88%97%E2%80%94%E2%80%94%E5%85%B3%E8%81%94%E6%95%B0%E7%BB%84%EF%BC%88Associative-Array%EF%BC%89.html</link><description>ä¸€ã€å‰è¨€
====

å‰ä¸ä¹…ï¼Œå’±ä»¬å¸¦æ¥äº†å…³äºç¾²å’Œæ•°æ®åº“é›†åˆç±»å‹ä¸­çš„åµŒå¥—è¡¨çš„ä½¿ç”¨ï¼Œé¡ºå¸¦å’ŒOracle19cå¯¹æ¯”äº†ä¸€ä¸‹ï¼ŒåŸºæœ¬åŠŸèƒ½ä¸Šå¤§å·®ä¸å·®ï¼Œå‰æ–‡é“¾æ¥å¦‚ä¸‹

[ç¾²å’Œï¼ˆhaloï¼‰æ•°æ®åº“é›†åˆç±»å‹ç³»åˆ—â€”â€”å­¦ä¼šåµŒå¥—è¡¨(Nested Table)çš„æ­£ç¡®ä½¿ç”¨](https://www.modb.pro/db/1844644828275109888)  

ä¸Šæ¬¡å°†ä¸¤æ¬¾æ•°æ®åº“çš„æµ‹è¯•å†…å®¹å’Œè¿è¡Œç»“æœä¸€èµ·æˆªå›¾ï¼Œç»“æœè´´åˆ°æ–‡ç« ä¸­åè€Œæ˜¾å¾—ä¸æ˜¯å¾ˆæ¸…æ¥šï¼Œåƒæˆ‘è¿™ç§çœ¼ç¥ä¸å¤ªå¥½ä½¿çš„åŒå­¦ï¼Œè¿˜éœ€è¦å¤šç‚¹ä¸€ä¸‹å›¾ç‰‡ã€‚</description><guid isPermaLink="true">https://Z-Xiao-M.github.io/github.io/post/%E7%BE%B2%E5%92%8C%EF%BC%88halo%EF%BC%89%E6%95%B0%E6%8D%AE%E5%BA%93%E9%9B%86%E5%90%88%E7%B1%BB%E5%9E%8B%E7%B3%BB%E5%88%97%E2%80%94%E2%80%94%E5%85%B3%E8%81%94%E6%95%B0%E7%BB%84%EF%BC%88Associative-Array%EF%BC%89.html</guid><pubDate>Mon, 01 Sep 2025 07:09:48 +0000</pubDate></item><item><title>ç¾²å’Œï¼ˆhaloï¼‰æ•°æ®åº“é›†åˆç±»å‹ç³»åˆ—â€”â€”å­¦ä¼šåµŒå¥—è¡¨(Nested Table)çš„æ­£ç¡®ä½¿ç”¨</title><link>https://Z-Xiao-M.github.io/github.io/post/%E7%BE%B2%E5%92%8C%EF%BC%88halo%EF%BC%89%E6%95%B0%E6%8D%AE%E5%BA%93%E9%9B%86%E5%90%88%E7%B1%BB%E5%9E%8B%E7%B3%BB%E5%88%97%E2%80%94%E2%80%94%E5%AD%A6%E4%BC%9A%E5%B5%8C%E5%A5%97%E8%A1%A8%28Nested-Table%29%E7%9A%84%E6%AD%A3%E7%A1%AE%E4%BD%BF%E7%94%A8.html</link><description>ä¸€ã€é›†åˆç±»å‹
======

åœ¨Oracleæ•°æ®åº“ä¸­é›†åˆç±»å‹åˆ†ä¸ºä»¥ä¸‹ä¸‰ç§ï¼Œåˆ†åˆ«ä¸ºå…³è”æ•°ç»„(Associative Array)ã€åµŒå¥—è¡¨(Nested Table)å’Œå¯å˜æ•°ç»„(VARRAY)ã€‚</description><guid isPermaLink="true">https://Z-Xiao-M.github.io/github.io/post/%E7%BE%B2%E5%92%8C%EF%BC%88halo%EF%BC%89%E6%95%B0%E6%8D%AE%E5%BA%93%E9%9B%86%E5%90%88%E7%B1%BB%E5%9E%8B%E7%B3%BB%E5%88%97%E2%80%94%E2%80%94%E5%AD%A6%E4%BC%9A%E5%B5%8C%E5%A5%97%E8%A1%A8%28Nested-Table%29%E7%9A%84%E6%AD%A3%E7%A1%AE%E4%BD%BF%E7%94%A8.html</guid><pubDate>Mon, 01 Sep 2025 07:08:57 +0000</pubDate></item><item><title>å¦‚ä½•ä½¿ç”¨ç¾²å’Œï¼ˆHaloï¼‰æ•°æ®åº“çš„åŠ¨æ€SQLè¯­å¥åŠŸèƒ½</title><link>https://Z-Xiao-M.github.io/github.io/post/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E7%BE%B2%E5%92%8C%EF%BC%88Halo%EF%BC%89%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%8A%A8%E6%80%81SQL%E8%AF%AD%E5%8F%A5%E5%8A%9F%E8%83%BD.html</link><description>ä¸€ã€å‰è¨€
====

SQLè¯­å¥åœ¨**ç¨‹åºç¼–è¯‘**æœŸé—´å°±å·²ç»ç¡®å®šï¼Œç»å¤§å¤šæ•°çš„ç¼–è¯‘æƒ…å†µå±äºè¿™ç§ç±»å‹ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºé™æ€SQLã€‚</description><guid isPermaLink="true">https://Z-Xiao-M.github.io/github.io/post/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E7%BE%B2%E5%92%8C%EF%BC%88Halo%EF%BC%89%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%8A%A8%E6%80%81SQL%E8%AF%AD%E5%8F%A5%E5%8A%9F%E8%83%BD.html</guid><pubDate>Mon, 01 Sep 2025 07:08:07 +0000</pubDate></item><item><title>ç¾²å’Œï¼ˆHaloï¼‰æ•°æ®åº“RAWç±»å‹åˆä½“éªŒ</title><link>https://Z-Xiao-M.github.io/github.io/post/%E7%BE%B2%E5%92%8C%EF%BC%88Halo%EF%BC%89%E6%95%B0%E6%8D%AE%E5%BA%93RAW%E7%B1%BB%E5%9E%8B%E5%88%9D%E4%BD%93%E9%AA%8C.html</link><description>ä¸€ã€RAWç±»å‹å›é¡¾
=========

åœ¨Oracleæ•°æ®åº“ä¸­ï¼ŒRAWç±»å‹æ˜¯ä¸€ç§å¯å˜é•¿æ•°æ®ç±»å‹ï¼Œä¸€èˆ¬ç”¨äºå­˜å‚¨äºŒè¿›åˆ¶æ•°æ®ã€‚</description><guid isPermaLink="true">https://Z-Xiao-M.github.io/github.io/post/%E7%BE%B2%E5%92%8C%EF%BC%88Halo%EF%BC%89%E6%95%B0%E6%8D%AE%E5%BA%93RAW%E7%B1%BB%E5%9E%8B%E5%88%9D%E4%BD%93%E9%AA%8C.html</guid><pubDate>Mon, 01 Sep 2025 07:07:24 +0000</pubDate></item><item><title>æ‰“ç ´è®¤çŸ¥å¹»åƒï¼šä½ å†™çš„SQLæ˜¯å¦å¦‚ä½ å¿ƒæ„ï¼Ÿ</title><link>https://Z-Xiao-M.github.io/github.io/post/%E6%89%93%E7%A0%B4%E8%AE%A4%E7%9F%A5%E5%B9%BB%E5%83%8F%EF%BC%9A%E4%BD%A0%E5%86%99%E7%9A%84SQL%E6%98%AF%E5%90%A6%E5%A6%82%E4%BD%A0%E5%BF%83%E6%84%8F%EF%BC%9F.html</link><description>ä¸€ã€å‰è¨€
====

æœ€è¿‘ç½‘ä¸Šå†²æµªçš„æ—¶å€™ï¼Œç¿»ç€ç¿»ç€ç¿»åˆ°ä¸€ç¯‡æœ‰è¶£çš„æ–‡ç« ï¼Œä¼°æ‘¸ç€åº”è¯¥æ˜¯ç›–è€å¸ˆå†™çš„ã€‚</description><guid isPermaLink="true">https://Z-Xiao-M.github.io/github.io/post/%E6%89%93%E7%A0%B4%E8%AE%A4%E7%9F%A5%E5%B9%BB%E5%83%8F%EF%BC%9A%E4%BD%A0%E5%86%99%E7%9A%84SQL%E6%98%AF%E5%90%A6%E5%A6%82%E4%BD%A0%E5%BF%83%E6%84%8F%EF%BC%9F.html</guid><pubDate>Mon, 01 Sep 2025 06:55:16 +0000</pubDate></item><item><title>Oracleã€PostgreSQLã€ç¾²å’Œï¼ˆHaloï¼‰æ•°æ®åº“ä¸­çš„çš„INã€OUT å’Œ INOUTå‚æ•°æ¨¡å¼</title><link>https://Z-Xiao-M.github.io/github.io/post/Oracle%E3%80%81PostgreSQL%E3%80%81%E7%BE%B2%E5%92%8C%EF%BC%88Halo%EF%BC%89%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%AD%E7%9A%84%E7%9A%84IN%E3%80%81OUT-%E5%92%8C-INOUT%E5%8F%82%E6%95%B0%E6%A8%A1%E5%BC%8F.html</link><description>ä¸€ã€å‰è¨€
----

å‰äº›å¤©çœ‹åˆ°PostgreSQLåˆ†ä¼šåœ¨å¾®ä¿¡ä¸Šçš„ä¸€åˆ™ç¿»è¯‘åˆ†äº«ï¼Œæ ‡é¢˜ä¸ºOracle ä¸ PostgreSQL ä¸­çš„ INã€OUT å’Œ INOUT å‚æ•°ã€‚</description><guid isPermaLink="true">https://Z-Xiao-M.github.io/github.io/post/Oracle%E3%80%81PostgreSQL%E3%80%81%E7%BE%B2%E5%92%8C%EF%BC%88Halo%EF%BC%89%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%AD%E7%9A%84%E7%9A%84IN%E3%80%81OUT-%E5%92%8C-INOUT%E5%8F%82%E6%95%B0%E6%A8%A1%E5%BC%8F.html</guid><pubDate>Mon, 01 Sep 2025 06:53:37 +0000</pubDate></item><item><title>ç¾²å’Œï¼ˆHaloï¼‰æ•°æ®åº“â€”â€”DBMS_RANDOMæµ…å°</title><link>https://Z-Xiao-M.github.io/github.io/post/%E7%BE%B2%E5%92%8C%EF%BC%88Halo%EF%BC%89%E6%95%B0%E6%8D%AE%E5%BA%93%E2%80%94%E2%80%94DBMS_RANDOM%E6%B5%85%E5%B0%9D.html</link><description>&lt;html&gt;
&lt;body&gt;
&lt;!--StartFragment--&gt;&lt;p style='padding: 0px; margin: 10px 0px; box-sizing: border-box; font-size: 14px; line-height: 1.5; color: rgb(0, 0, 0); font-family: PingFangSC-Regular, &amp;quot;Microsoft Yahei&amp;quot;; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;'&gt;åœ¨ORACLEä¸­DBMS_RANDOMç”¨äºç”Ÿæˆéšæœºæ•°ã€éšæœºå­—ç¬¦ä¸²ç­‰ã€‚</description><guid isPermaLink="true">https://Z-Xiao-M.github.io/github.io/post/%E7%BE%B2%E5%92%8C%EF%BC%88Halo%EF%BC%89%E6%95%B0%E6%8D%AE%E5%BA%93%E2%80%94%E2%80%94DBMS_RANDOM%E6%B5%85%E5%B0%9D.html</guid><pubDate>Mon, 01 Sep 2025 06:52:44 +0000</pubDate></item><item><title>ç¾²å’Œï¼ˆHaloï¼‰æ•°æ®åº“â€”â€”DBMS_SQLæµ…å°</title><link>https://Z-Xiao-M.github.io/github.io/post/%E7%BE%B2%E5%92%8C%EF%BC%88Halo%EF%BC%89%E6%95%B0%E6%8D%AE%E5%BA%93%E2%80%94%E2%80%94DBMS_SQL%E6%B5%85%E5%B0%9D.html</link><description>æœ¬æ–‡å°†å‘å¤§å®¶å±•ç¤ºå¦‚ä½•åœ¨ç¾²å’Œï¼ˆHaloï¼‰æ•°æ®åº“ä¸­ä½¿ç”¨DBMS\_SQLï¼Œæœ¬æ–‡æµ‹è¯•æ¡ˆä¾‹é™¤éƒ¨åˆ†è¡¨ç»“æ„å’Œéƒ¨åˆ†æµ‹è¯•æ•°æ®ä¹‹å¤–ï¼Œå…¶ä½™å‡æ¥è‡ªORACLEå®˜æ–¹æµ‹è¯•æ–‡æ¡£ï¼Œæ‰€æœ‰æµ‹è¯•æ¡ˆä¾‹æ”¾ç½®æ–‡ç« æœ«å°¾ä»¥ä¾›å­¦ä¹ ä½¿ç”¨ã€‚</description><guid isPermaLink="true">https://Z-Xiao-M.github.io/github.io/post/%E7%BE%B2%E5%92%8C%EF%BC%88Halo%EF%BC%89%E6%95%B0%E6%8D%AE%E5%BA%93%E2%80%94%E2%80%94DBMS_SQL%E6%B5%85%E5%B0%9D.html</guid><pubDate>Mon, 01 Sep 2025 06:47:36 +0000</pubDate></item><item><title>èŠèŠpg_bulkloadçš„å¤§æ¦‚çš„å®ç°é€»è¾‘</title><link>https://Z-Xiao-M.github.io/github.io/post/%E8%81%8A%E8%81%8Apg_bulkload%E7%9A%84%E5%A4%A7%E6%A6%82%E7%9A%84%E5%AE%9E%E7%8E%B0%E9%80%BB%E8%BE%91.html</link><description>&gt; å¥½å¥½å¥½ï¼Œå¥½ä¹…ä¸è§ï¼Œæœ€è¿‘å¶ç„¶äº†è§£åˆ°äº†pg\_bulkloadè¿™ä¸€æ’ä»¶ï¼Œç„¶åèŠ±äº†ç‚¹æ—¶é—´çœ‹äº†çœ‹å®ƒæ˜¯å¦‚ä½•å®ç°çš„ï¼Œåˆæƒ³åˆ°å¥½ä¹…æ²¡æœ‰å†™ä¸œè¥¿äº†ï¼Œå’•äº†å¤ªä¹…ï¼Œæœ‰ç‚¹æ€ªä¸å¥½æ„æ€çš„ï¼Œæ‰€ä»¥å†³å®šå†™ç‚¹ä¸œè¥¿ï¼Œæ‘†è„±é¸½å­ğŸ•Šçš„å«Œç–‘ã€‚</description><guid isPermaLink="true">https://Z-Xiao-M.github.io/github.io/post/%E8%81%8A%E8%81%8Apg_bulkload%E7%9A%84%E5%A4%A7%E6%A6%82%E7%9A%84%E5%AE%9E%E7%8E%B0%E9%80%BB%E8%BE%91.html</guid><pubDate>Mon, 01 Sep 2025 06:32:59 +0000</pubDate></item><item><title>æ²¡æœ‰fromæ˜¯å¦èƒ½å¤Ÿæ‰§è¡Œcountæ“ä½œ</title><link>https://Z-Xiao-M.github.io/github.io/post/%E6%B2%A1%E6%9C%89from%E6%98%AF%E5%90%A6%E8%83%BD%E5%A4%9F%E6%89%A7%E8%A1%8Ccount%E6%93%8D%E4%BD%9C.html</link><description>ä¸€ã€åœºæ™¯æ„å»º
======

è¿™æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„åœºæ™¯ï¼Œè¿™é‡Œå­˜åœ¨ä¸€å¼ è¡¨ï¼Œè¡¨åtï¼Œå¾€å…¶ä¸­éšä¾¿æ’å…¥ä¸‰è¡Œæ•°æ®ï¼Œç„¶åæ‰§è¡ŒæŸ¥è¯¢è¯­å¥ï¼š`select count(*) from t;`

    create table t(id integer);
    insert into t values(1),(2),(3);
    select count(*) from t;

æ‰§è¡Œç»“æœ

    postgres=# create table t(id integer);
    CREATE TABLE
    postgres=# insert into t values(1),(2),(3);
    INSERT 0 3
    postgres=# select count(*) from t;
     count 
    -------
         3
    (1 row)

å¯ä»¥çœ‹åˆ°æ‰§è¡Œcountç»“æœä¸º3ï¼Œè¿™åœ¨æ­£å¸¸ä¸è¿‡äº†ã€‚</description><guid isPermaLink="true">https://Z-Xiao-M.github.io/github.io/post/%E6%B2%A1%E6%9C%89from%E6%98%AF%E5%90%A6%E8%83%BD%E5%A4%9F%E6%89%A7%E8%A1%8Ccount%E6%93%8D%E4%BD%9C.html</guid><pubDate>Mon, 01 Sep 2025 06:30:27 +0000</pubDate></item><item><title>å¤–å›½CTOä¹Ÿæ„Ÿå…´è¶£çš„å¼€æºæ•°æ®åº“é¡¹ç›®â€”â€”openHalo</title><link>https://Z-Xiao-M.github.io/github.io/post/%E5%A4%96%E5%9B%BDCTO%E4%B9%9F%E6%84%9F%E5%85%B4%E8%B6%A3%E7%9A%84%E5%BC%80%E6%BA%90%E6%95%B0%E6%8D%AE%E5%BA%93%E9%A1%B9%E7%9B%AE%E2%80%94%E2%80%94openHalo.html</link><description>ä¸€ã€openHalo
==========

å¤§æ¦‚ä¸‰ä¸ªç¤¼æ‹œå‰ï¼Œä¹Ÿå°±æ˜¯å››æœˆä¸€ï¼ˆæ„šäººèŠ‚ï¼‰çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°†ç¾²å’Œï¼ˆHaloï¼‰æ•°æ®åº“å…³äºMySQLå…¼å®¹èƒ½åŠ›è¿™ä¸€å—ï¼Œç‹¬ç«‹åšæˆäº†ä¸€ä¸ªé¡¹ç›®ï¼Œå¹¶ä¸”åœ¨githubä¸Šå¼€æºäº†å‡ºå»ã€‚</description><guid isPermaLink="true">https://Z-Xiao-M.github.io/github.io/post/%E5%A4%96%E5%9B%BDCTO%E4%B9%9F%E6%84%9F%E5%85%B4%E8%B6%A3%E7%9A%84%E5%BC%80%E6%BA%90%E6%95%B0%E6%8D%AE%E5%BA%93%E9%A1%B9%E7%9B%AE%E2%80%94%E2%80%94openHalo.html</guid><pubDate>Mon, 01 Sep 2025 06:29:44 +0000</pubDate></item><item><title>PostgreSQLâ€”â€”å…³äºautocommitåŠŸèƒ½çš„å®ç°</title><link>https://Z-Xiao-M.github.io/github.io/post/PostgreSQL%E2%80%94%E2%80%94%E5%85%B3%E4%BA%8Eautocommit%E5%8A%9F%E8%83%BD%E7%9A%84%E5%AE%9E%E7%8E%B0.html</link><description>ä¸€ã€å‰è¨€
====

æ–‡ç« æ ‡é¢˜ä¸ºPostgreSQLâ€”â€”å…³äºautocommitåŠŸèƒ½çš„å®ç°ï¼Œå…¶å®æ›´ä¸ºå‡†ç¡®æ¥è¯´åº”è¯¥æ˜¯psqlâ€”â€”å…³äºautocommitåŠŸèƒ½çš„å®ç°ï¼Œå› ä¸ºè¿™ä¸ªå‚æ•°å…¶å®å±äºpsqlã€‚</description><guid isPermaLink="true">https://Z-Xiao-M.github.io/github.io/post/PostgreSQL%E2%80%94%E2%80%94%E5%85%B3%E4%BA%8Eautocommit%E5%8A%9F%E8%83%BD%E7%9A%84%E5%AE%9E%E7%8E%B0.html</guid><pubDate>Mon, 01 Sep 2025 06:27:09 +0000</pubDate></item><item><title>ç©ä¸€ç©ç³»åˆ—â€”â€”ç©ç©pg_dirtyread</title><link>https://Z-Xiao-M.github.io/github.io/post/%E7%8E%A9%E4%B8%80%E7%8E%A9%E7%B3%BB%E5%88%97%E2%80%94%E2%80%94%E7%8E%A9%E7%8E%A9pg_dirtyread.html</link><description>ä¸€ã€å‰è¨€
====

å¾ˆæ—©å…¶å®å°±çŸ¥é“æœ‰è¿™ä¹ˆä¸€ä¸ªæ’ä»¶å­˜åœ¨ï¼Œå«åšpg\_dirtyreadï¼Œå°±æ˜¯ä¸€ç›´æ²¡å»ä¸Šæ‰‹ç©ç©ï¼Œè¶ç€æœ‰ç©ºï¼Œå†™ç‚¹ä¸œè¥¿ã€‚</description><guid isPermaLink="true">https://Z-Xiao-M.github.io/github.io/post/%E7%8E%A9%E4%B8%80%E7%8E%A9%E7%B3%BB%E5%88%97%E2%80%94%E2%80%94%E7%8E%A9%E7%8E%A9pg_dirtyread.html</guid><pubDate>Mon, 01 Sep 2025 06:26:19 +0000</pubDate></item><item><title>çœ‹æ‡‚PostgreSQL whereå­å¥ä¸­æ¡ä»¶çš„å…ˆåæ‰§è¡Œé¡ºåº</title><link>https://Z-Xiao-M.github.io/github.io/post/%E7%9C%8B%E6%87%82PostgreSQL-where%E5%AD%90%E5%8F%A5%E4%B8%AD%E6%9D%A1%E4%BB%B6%E7%9A%84%E5%85%88%E5%90%8E%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F.html</link><description>ä¸€ã€å‰è¨€
====

å‰å‡ å¤©æœ‰ä¸ªåŒäº‹é—®äº†æˆ‘ä¸€ä¸ªé—®é¢˜ï¼Œé—®é¢˜ç®€åŒ–ä¹‹åï¼Œå¤§æ¦‚å¦‚ä¸‹é¢æè¿°ï¼šåœ¨PostgreSQLä¸­ï¼Œå­˜åœ¨ä¸€å¼ è¡¨taï¼Œè¡¨ä¸­æ•°æ®å­˜åœ¨ä¸¤ä¸ªå€¼ï¼Œåˆ†åˆ«æ˜¯é›¶å’Œä¸€ã€‚</description><guid isPermaLink="true">https://Z-Xiao-M.github.io/github.io/post/%E7%9C%8B%E6%87%82PostgreSQL-where%E5%AD%90%E5%8F%A5%E4%B8%AD%E6%9D%A1%E4%BB%B6%E7%9A%84%E5%85%88%E5%90%8E%E6%89%A7%E8%A1%8C%E9%A1%BA%E5%BA%8F.html</guid><pubDate>Mon, 01 Sep 2025 06:25:25 +0000</pubDate></item><item><title>ç©ä¸€ç©ç³»åˆ—â€”â€”ç©ç©postgres_fdw</title><link>https://Z-Xiao-M.github.io/github.io/post/%E7%8E%A9%E4%B8%80%E7%8E%A9%E7%B3%BB%E5%88%97%E2%80%94%E2%80%94%E7%8E%A9%E7%8E%A9postgres_fdw.html</link><description>ä¸€ã€å‰è¨€
====

æœ¬æ–‡ä»…è®°å½•å’Œåˆ†äº«ä¸€ä¸‹å…³äºPostgreSQLçš„FDWï¼ˆå¤–éƒ¨æ•°æ®åŒ…è£…å™¨ï¼‰çš„ç®€å•ä»‹ç»å’Œä½¿ç”¨ï¼Œæ­¤æ¬¡ä¸åŒ…å«æºç åˆ†æã€‚</description><guid isPermaLink="true">https://Z-Xiao-M.github.io/github.io/post/%E7%8E%A9%E4%B8%80%E7%8E%A9%E7%B3%BB%E5%88%97%E2%80%94%E2%80%94%E7%8E%A9%E7%8E%A9postgres_fdw.html</guid><pubDate>Mon, 01 Sep 2025 06:21:16 +0000</pubDate></item><item><title>ç©ä¸€ç©ç³»åˆ—â€”â€”ç©ç©login_hook</title><link>https://Z-Xiao-M.github.io/github.io/post/%E7%8E%A9%E4%B8%80%E7%8E%A9%E7%B3%BB%E5%88%97%E2%80%94%E2%80%94%E7%8E%A9%E7%8E%A9login_hook.html</link><description>ä¸€ã€PostgreSQLç™»å½•äº‹ä»¶è§¦å‘å™¨
===================

åœ¨PostgreSQL17ç‰ˆæœ¬å¼•å…¥äº†ç™»å½•äº‹ä»¶è§¦å‘å™¨ï¼Œå¯ä»¥ç”¨äºç™»å½•ä¹‹åè®°å½•ä¸€äº›ä¿¡æ¯æˆ–è€…å®Œæˆä¸€äº›åˆå§‹åŒ–åŠ¨ä½œã€‚</description><guid isPermaLink="true">https://Z-Xiao-M.github.io/github.io/post/%E7%8E%A9%E4%B8%80%E7%8E%A9%E7%B3%BB%E5%88%97%E2%80%94%E2%80%94%E7%8E%A9%E7%8E%A9login_hook.html</guid><pubDate>Mon, 01 Sep 2025 06:20:15 +0000</pubDate></item><item><title>æ˜æ˜æƒ³æ‰§è¡Œçš„SQLæ˜¯DELETEã€UPDATEï¼Œä½†ä¸ºä»€ä¹ˆçœ‹åˆ°çš„æ˜¯SELECTï¼ˆFDWçš„å®ç°åŸç†è§£æï¼‰</title><link>https://Z-Xiao-M.github.io/github.io/post/%E6%98%8E%E6%98%8E%E6%83%B3%E6%89%A7%E8%A1%8C%E7%9A%84SQL%E6%98%AFDELETE%E3%80%81UPDATE%EF%BC%8C%E4%BD%86%E4%B8%BA%E4%BB%80%E4%B9%88%E7%9C%8B%E5%88%B0%E7%9A%84%E6%98%AFSELECT%EF%BC%88FDW%E7%9A%84%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86%E8%A7%A3%E6%9E%90%EF%BC%89.html</link><description>ä¸€ã€åœºæ™¯å¤ç°
======

å¼€é—¨è§å±±ï¼Œä¸€ä¸ªå…³äºoracle\_fdwçš„ç®€å•åœºæ™¯å¦‚ä¸‹ï¼š

    halo0root=# \d+ emp
                                                   Foreign table 'public.emp'
     Column |         Type          | Collation | Nullable | Default | FDW options  | Storage  | Stats target | Description 
    --------+-----------------------+-----------+----------+---------+--------------+----------+--------------+-------------
     name   | character varying(20) |           | not null |         | (key 'true') | extended |              | 
     age    | numeric               |           |          |         |              | main     |              | 
    Server: oradb
    FDW options: (schema 'ZM', 'table' 'EMP')
    
    halo0root=# \des+
                                                          List of foreign servers
     Name  | Owner | Foreign-data wrapper | Access privileges | Type | Version |               FDW options                | Description 
    -------+-------+----------------------+-------------------+------+---------+------------------------------------------+-------------
     oradb | halo  | oracle_fdw           |                   |      |         | (dbserver '//10.16.6.188:1521/orclpdb1') | 
    (1 row)
    
    halo0root=# EXPLAIN VERBOSE DELETE FROM emp WHERE age = 25;
                                                            QUERY PLAN                                                         
    ---------------------------------------------------------------------------------------------------------------------------
     Delete on public.emp  (cost=10000.00..20000.00 rows=0 width=0)
       Oracle statement: DELETE FROM 'ZM'.'EMP' WHERE 'NAME' = :k1
       -&gt;  Foreign Scan on public.emp  (cost=10000.00..20000.00 rows=1000 width=58)
             Output: name
             Oracle query: SELECT /*9ad36f25074bd711*/ r1.'NAME', r1.'AGE' FROM 'ZM'.'EMP' r1 WHERE (r1.'AGE' = 25) FOR UPDATE
             Oracle plan: SELECT STATEMENT
             Oracle plan:   FOR UPDATE
             Oracle plan:     BUFFER SORT
             Oracle plan:       TABLE ACCESS FULL EMP  (filter 'R1'.'AGE'=25)
     Query Identifier: -1174117518881599247
    (10 rows)

è¿™é‡Œå¯ä»¥å¾ˆæ˜æ˜¾çš„çœ‹åˆ°ï¼Œè™½ç„¶æˆ‘ä»¬æ•²å¾—æ˜¯EXPLAIN VERBOSE DELETE ...ï¼Œä½†æ˜¯å®é™…çš„Oracle queryå´æ˜¯SELECTï¼ŒåŒæ—¶UPDATEä¹Ÿæ˜¯å¦‚æ­¤

    halo0root=# EXPLAIN VERBOSE UPDATE emp SET name = 'zzz' WHERE age = 25;
                                                            QUERY PLAN                                                         
    ---------------------------------------------------------------------------------------------------------------------------
     Update on public.emp  (cost=10000.00..20000.00 rows=0 width=0)
       Oracle statement: UPDATE 'ZM'.'EMP' SET 'NAME' = :p1 WHERE 'NAME' = :k1
       -&gt;  Foreign Scan on public.emp  (cost=10000.00..20000.00 rows=1000 width=230)
             Output: 'zzz'::character varying(20), name, emp.*
             Oracle query: SELECT /*9ad36f25074bd711*/ r1.'NAME', r1.'AGE' FROM 'ZM'.'EMP' r1 WHERE (r1.'AGE' = 25) FOR UPDATE
             Oracle plan: SELECT STATEMENT
             Oracle plan:   FOR UPDATE
             Oracle plan:     BUFFER SORT
             Oracle plan:       TABLE ACCESS FULL EMP  (filter 'R1'.'AGE'=25)
     Query Identifier: -2711433616002583057
    (10 rows)

é‚£ä¹ˆé—®é¢˜å°±å¦‚æ–‡ç« æ ‡é¢˜æ‰€è¿°äº†ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ

  

äºŒã€åŸç†åˆ†æ
======

åŸå› å…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œå› ä¸ºå¯¹äºPostgreSQLè€Œè¨€ï¼Œå¤–éƒ¨è¡¨æ˜¯ä¸€ç§å¾ˆç‰¹æ®Šçš„å­˜åœ¨ï¼Œå®ƒä»…ä»…åªæ˜¯ä¸€ä¸ªè¿œç«¯è¡¨çš„æ˜ å°„ï¼Œå®é™…çš„æ•°æ®ä¾æ—§è¿˜æ˜¯å­˜å‚¨åœ¨è¿œç«¯ï¼Œ

å½“æˆ‘ä»¬åœ¨æœ¬åœ°çš„PostgreSQLè®¿é—®å¤–éƒ¨è¡¨çš„æ—¶å€™ï¼Œå®é™…ä¸Šå°±æ˜¯å°†å½“å‰çš„æŸ¥è¯¢è¯­å¥ï¼Œä¸‹å‘è‡³è¿œç«¯æ•°æ®åº“ï¼Œå†å°†æŸ¥è¯¢åˆ°çš„æ•°æ®ä¼ å›æœ¬åœ°çš„PostgreSQLä¸­å‚ä¸å®é™…çš„è®¡ç®—ä¹‹ç±»çš„ã€‚</description><guid isPermaLink="true">https://Z-Xiao-M.github.io/github.io/post/%E6%98%8E%E6%98%8E%E6%83%B3%E6%89%A7%E8%A1%8C%E7%9A%84SQL%E6%98%AFDELETE%E3%80%81UPDATE%EF%BC%8C%E4%BD%86%E4%B8%BA%E4%BB%80%E4%B9%88%E7%9C%8B%E5%88%B0%E7%9A%84%E6%98%AFSELECT%EF%BC%88FDW%E7%9A%84%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86%E8%A7%A3%E6%9E%90%EF%BC%89.html</guid><pubDate>Mon, 01 Sep 2025 06:19:02 +0000</pubDate></item><item><title>åœ¨PostgreSQLä¸­ï¼Œä½ ä¸ä»…å¯ä»¥çœ‹åˆ°Bad Appleï¼Œè¿˜å¯ä»¥çœ‹æ•…äººå”±è·³ã€rapã€æ‰“ç¯®çƒ</title><link>https://Z-Xiao-M.github.io/github.io/post/%E5%9C%A8PostgreSQL%E4%B8%AD%EF%BC%8C%E4%BD%A0%E4%B8%8D%E4%BB%85%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%88%B0Bad-Apple%EF%BC%8C%E8%BF%98%E5%8F%AF%E4%BB%A5%E7%9C%8B%E6%95%85%E4%BA%BA%E5%94%B1%E8%B7%B3%E3%80%81rap%E3%80%81%E6%89%93%E7%AF%AE%E7%90%83.html</link><description>ä¸€ã€å‰è¨€
====

ä¹Ÿæ˜¯åœ¨å‰ä¸ä¹…ï¼Œæˆ‘ç¿»åˆ°äº†ä¸€ä¸ªâ€œæœ‰è¶£â€çš„é¡¹ç›®ï¼Œå¦‚æ ‡é¢˜æ‰€è¨€ï¼Œè¿™ä¸ªPostgreSQLæ’ä»¶é¡¹ç›®å°±æ˜¯å¯èƒ½åšåˆ°åœ¨psqlå®¢æˆ·ç«¯æ’­æ”¾Bad Appleï¼Œå’Œé¸½é¸½çš„å”±è·³ã€rapã€æ‰“ç¯®çƒçš„ååœºé¢ã€‚</description><guid isPermaLink="true">https://Z-Xiao-M.github.io/github.io/post/%E5%9C%A8PostgreSQL%E4%B8%AD%EF%BC%8C%E4%BD%A0%E4%B8%8D%E4%BB%85%E5%8F%AF%E4%BB%A5%E7%9C%8B%E5%88%B0Bad-Apple%EF%BC%8C%E8%BF%98%E5%8F%AF%E4%BB%A5%E7%9C%8B%E6%95%85%E4%BA%BA%E5%94%B1%E8%B7%B3%E3%80%81rap%E3%80%81%E6%89%93%E7%AF%AE%E7%90%83.html</guid><pubDate>Mon, 01 Sep 2025 06:18:11 +0000</pubDate></item><item><title>ç®€å•èŠèŠPostgreSQLä¸­çš„å¤šæ€ä¼ªç±»å‹</title><link>https://Z-Xiao-M.github.io/github.io/post/%E7%AE%80%E5%8D%95%E8%81%8A%E8%81%8APostgreSQL%E4%B8%AD%E7%9A%84%E5%A4%9A%E6%80%81%E4%BC%AA%E7%B1%BB%E5%9E%8B.html</link><description>ä¸€ã€å‰è¨€
====

ä¹Ÿæ˜¯å¥½ä¹…æ²¡æœ‰å†™æ–‡ç« äº†ï¼Œä¸»è¦æ˜¯å‰é˜µå­æ¯”è¾ƒå¿™ï¼Œè¿˜æœ‰å¤–åŠ ä¸Šå–œæ¬¢éª‘è½¦å‡ºå»å…œé£ï¼Œä»¥è‡³äºä¸€è€Œå†ï¼Œå†è€Œä¸‰çš„å’•å’•ã€‚</description><guid isPermaLink="true">https://Z-Xiao-M.github.io/github.io/post/%E7%AE%80%E5%8D%95%E8%81%8A%E8%81%8APostgreSQL%E4%B8%AD%E7%9A%84%E5%A4%9A%E6%80%81%E4%BC%AA%E7%B1%BB%E5%9E%8B.html</guid><pubDate>Sun, 31 Aug 2025 08:18:02 +0000</pubDate></item><item><title>æ­å»ºä¸€ä¸ªå¤šä¸»å¤åˆ¶æ•°æ®å›ç¯åœºæ™¯</title><link>https://Z-Xiao-M.github.io/github.io/post/%E6%90%AD%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%A4%9A%E4%B8%BB%E5%A4%8D%E5%88%B6%E6%95%B0%E6%8D%AE%E5%9B%9E%E7%8E%AF%E5%9C%BA%E6%99%AF.html</link><description>ä¸€ã€å‰è¨€
====

æœ€è¿‘ä¹Ÿæ˜¯çœ‹ç€çœ‹ç€ï¼Œçœ‹åˆ°äº†é€»è¾‘å¤åˆ¶è¿™å—ï¼Œäº‹å®ä¸Šæˆ‘å¾ˆå°‘æ¥è§¦è¿‡è¿™å—ï¼Œæ‰€ä»¥å°±å½“ç»ƒç»ƒæ‰‹äº†ã€‚</description><guid isPermaLink="true">https://Z-Xiao-M.github.io/github.io/post/%E6%90%AD%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%A4%9A%E4%B8%BB%E5%A4%8D%E5%88%B6%E6%95%B0%E6%8D%AE%E5%9B%9E%E7%8E%AF%E5%9C%BA%E6%99%AF.html</guid><pubDate>Sun, 31 Aug 2025 08:03:25 +0000</pubDate></item><item><title>PostgreSQLâ€”â€”å…³äºä¸´æ—¶è¡¨çš„äºŒä¸‰äº‹</title><link>https://Z-Xiao-M.github.io/github.io/post/PostgreSQL%E2%80%94%E2%80%94%E5%85%B3%E4%BA%8E%E4%B8%B4%E6%97%B6%E8%A1%A8%E7%9A%84%E4%BA%8C%E4%B8%89%E4%BA%8B.html</link><description># ä¸€ã€å‰è¨€

è¯´èµ·ä¸´æ—¶è¡¨ï¼Œå¤šæ•°çš„DBAåŒå­¦ä»¬ç¬¬ä¸€æ—¶é—´éƒ½ä¼šæƒ³åˆ°Oracleçš„å…¨å±€ä¸´æ—¶è¡¨ï¼Œè€Œå¯¹äºPGè€Œè¨€ï¼Œè™½ç„¶å­˜åœ¨å¯¹åº”çš„å…¨å±€ä¸´æ—¶è¡¨è¯­æ³•ï¼Œä½†æ˜¯å¹¶æ²¡æœ‰å®è´¨çš„å…¨å±€ä¸´æ—¶è¡¨åŠŸèƒ½ã€‚</description><guid isPermaLink="true">https://Z-Xiao-M.github.io/github.io/post/PostgreSQL%E2%80%94%E2%80%94%E5%85%B3%E4%BA%8E%E4%B8%B4%E6%97%B6%E8%A1%A8%E7%9A%84%E4%BA%8C%E4%B8%89%E4%BA%8B.html</guid><pubDate>Sun, 31 Aug 2025 04:06:59 +0000</pubDate></item><item><title>å…³äº</title><link>https://Z-Xiao-M.github.io/github.io/about.html</link><description>ä¸çŸ¥é“å†™ç‚¹ä»€ä¹ˆï¼Œè„‘è¢‹ç©ºç©ºï¼Œ
çªç„¶è§‰å¾—è‡ªå·±ä¹Ÿå¹¶æ²¡æœ‰å¤šäº†è§£æˆ‘è‡ªå·±ã€‚</description><guid isPermaLink="true">https://Z-Xiao-M.github.io/github.io/about.html</guid><pubDate>Sun, 31 Aug 2025 07:27:51 +0000</pubDate></item></channel></rss>